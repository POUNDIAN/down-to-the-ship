  0%|                                                                                                    | 0/500 [00:00<?, ?it/s]You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















  5%|████▌                                                                                      | 25/500 [00:48<15:03,  1.90s/it]
  0%|                                                                                                     | 0/13 [00:00<?, ?it/s]










 85%|█████████████████████████████████████████████████████████████████████████████▊              | 11/13 [00:16<00:03,  1.66s/it]
  5%|████▌                                                                                      | 25/500 [01:09<15:03,  1.90s/it]/home/ubuntu/.venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:131: UserWarning: Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.
  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(























 10%|█████████                                                                                  | 50/500 [01:58<14:15,  1.90s/it]
{'loss': 1.3633, 'learning_rate': 2.2545090180360722e-05, 'epoch': 0.98}









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]
  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















 15%|█████████████▋                                                                             | 75/500 [03:08<13:28,  1.90s/it]
  0%|                                                                                                     | 0/13 [00:00<?, ?it/s]










 85%|█████████████████████████████████████████████████████████████████████████████▊              | 11/13 [00:16<00:03,  1.66s/it]
 15%|█████████████▋                                                                             | 75/500 [03:29<13:28,  1.90s/it]/home/ubuntu/.venv/lib/python3.10/site-packages/peft/utils/save_and_load.py:131: UserWarning: Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.
  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















 20%|██████████████████                                                                        | 100/500 [04:18<12:40,  1.90s/it]
  0%|                                                                                                     | 0/13 [00:00<?, ?it/s]










  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
{'eval_loss': 0.5176975131034851, 'eval_runtime': 21.3, 'eval_samples_per_second': 4.742, 'eval_steps_per_second': 0.61, 'epoch': 1.96}






















 25%|██████████████████████▌                                                                   | 125/500 [05:28<11:52,  1.90s/it]
  0%|                                                                                                     | 0/13 [00:00<?, ?it/s]










  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
{'eval_loss': 0.38424405455589294, 'eval_runtime': 21.3024, 'eval_samples_per_second': 4.741, 'eval_steps_per_second': 0.61, 'epoch': 2.45}
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















 30%|███████████████████████████                                                               | 150/500 [06:38<11:06,  1.90s/it]
  0%|                                                                                                     | 0/13 [00:00<?, ?it/s]










  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
{'eval_loss': 0.28952091932296753, 'eval_runtime': 21.3021, 'eval_samples_per_second': 4.741, 'eval_steps_per_second': 0.61, 'epoch': 2.94}
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















 35%|███████████████████████████████▍                                                          | 175/500 [07:48<10:17,  1.90s/it]
{'loss': 0.3157, 'learning_rate': 1.628256513026052e-05, 'epoch': 3.43}









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]

  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















 40%|███████████████████████████████████▊                                                      | 199/500 [08:57<09:34,  1.91s/it]
 40%|████████████████████████████████████                                                      | 200/500 [08:59<09:32,  1.91s/it]









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]

  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















 45%|████████████████████████████████████████▌                                                 | 225/500 [10:08<08:43,  1.91s/it]
{'loss': 0.201, 'learning_rate': 1.3777555110220442e-05, 'epoch': 4.41}









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]

  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















 50%|████████████████████████████████████████████▊                                             | 249/500 [11:17<07:57,  1.90s/it]
 50%|█████████████████████████████████████████████                                             | 250/500 [11:19<07:55,  1.90s/it]









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]

  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















 55%|█████████████████████████████████████████████████▎                                        | 274/500 [12:27<07:09,  1.90s/it]
 55%|█████████████████████████████████████████████████▌                                        | 275/500 [12:28<07:07,  1.90s/it]









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]

  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















 60%|█████████████████████████████████████████████████████▊                                    | 299/500 [13:37<06:22,  1.90s/it]
 60%|██████████████████████████████████████████████████████                                    | 300/500 [13:39<06:20,  1.90s/it]









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]

  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















 65%|██████████████████████████████████████████████████████████▌                               | 325/500 [14:48<05:32,  1.90s/it]
{'loss': 0.1024, 'learning_rate': 8.767535070140282e-06, 'epoch': 6.37}









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]

  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















 70%|██████████████████████████████████████████████████████████████▊                           | 349/500 [15:57<04:47,  1.90s/it]
 70%|██████████████████████████████████████████████████████████████▉                           | 350/500 [15:59<04:45,  1.90s/it]









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]

  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(





















 75%|███████████████████████████████████████████████████████████████████▌                      | 375/500 [17:09<03:57,  1.90s/it]
{'loss': 0.0848, 'learning_rate': 6.2625250501002e-06, 'epoch': 7.35}









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]

  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















 80%|███████████████████████████████████████████████████████████████████████▊                  | 399/500 [18:17<03:12,  1.90s/it]
 80%|████████████████████████████████████████████████████████████████████████                  | 400/500 [18:19<03:10,  1.90s/it]









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]

  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(





















 85%|████████████████████████████████████████████████████████████████████████████▎             | 424/500 [19:27<02:24,  1.90s/it]

 85%|████████████████████████████████████████████████████████████████████████████▌             | 425/500 [19:29<02:22,  1.90s/it]









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]

  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















 90%|█████████████████████████████████████████████████████████████████████████████████         | 450/500 [20:39<01:35,  1.90s/it]
{'loss': 0.0658, 'learning_rate': 2.5050100200400804e-06, 'epoch': 8.82}









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]

  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(





















 95%|█████████████████████████████████████████████████████████████████████████████████████▎    | 474/500 [21:47<00:49,  1.90s/it]

 95%|█████████████████████████████████████████████████████████████████████████████████████▌    | 475/500 [21:49<00:47,  1.90s/it]









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]

  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
/home/ubuntu/.venv/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(






















100%|██████████████████████████████████████████████████████████████████████████████████████████| 500/500 [22:59<00:00,  1.91s/it]
{'loss': 0.0593, 'learning_rate': 0.0, 'epoch': 9.8}









 92%|████████████████████████████████████████████████████████████████████████████████████▉       | 12/13 [00:18<00:01,  1.66s/it]

  warnings.warn("Setting `save_embedding_layers` to `True` as embedding layers found in `target_modules`.")
{'train_runtime': 1403.0116, 'train_samples_per_second': 0.713, 'train_steps_per_second': 0.356, 'train_loss': 0.36708610367774963, 'epoch': 9.8}
100%|██████████████████████████████████████████████████████████████████████████████████████████| 500/500 [23:22<00:00,  2.80s/it]